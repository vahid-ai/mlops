apiVersion: v1
kind: ConfigMap
metadata:
  name: feast-repo
  namespace: dfp
binaryData:
  registry.db: CnwKXAoObWFsd2FyZV9zYW1wbGUQAho4QW5kcm9pZCBBUEsgc2FtcGxlIGlkZW50aWZpZWQgYnkgdW5pcXVlIGRsdC1nZW5lcmF0ZWQgSUQiCXNhbXBsZV9pZEoDZGZwEhwKDAjfxPrJBhDg67+eARIMCNbI+skGEJDl74cDCjoKGgoHX19kdW1teSIKX19kdW1teV9pZEoDZGZwEhwKDAjfxPrJBhDwrcSeARIMCNbI+skGELil8ocDGgExIiQ3ZjNkN2I3NC01ZTY5LTQyNDktYjVkNC0yZTQwNzI2OTI5NjAqDAjK2PrJBhCIj42fAzK+AwqdAwoWbWFsd2FyZV9iYXRjaF9mZWF0dXJlcxIDZGZwGg5tYWx3YXJlX3NhbXBsZSIcCgppc19tYWx3YXJlEAQiDFRhcmdldCBsYWJlbCIPCgtkYXRhX3NvdXJjZRACIhEKDWRhdGFzZXRfc3BsaXQQAioLCgR0ZWFtEgNkZnAqFQoHZGF0YXNldBIKa3Jvbm9kcm9pZCoRCgV1c2FnZRIIdHJhaW5pbmcyBQiA54QPOtUBCAEaD2V2ZW50X3RpbWVzdGFtcFpQEjdzMzovL2tyb25vZHJvaWQvbWFpbi9kYnQvZmN0X3RyYWluaW5nX2RhdGFzZXQvKi5wYXJxdWV0GhVodHRwOi8vbG9jYWxob3N0OjgwMDCKATFmZWFzdC5pbmZyYS5vZmZsaW5lX3N0b3Jlcy5maWxlX3NvdXJjZS5GaWxlU291cmNlogEaa3Jvbm9kcm9pZF90cmFpbmluZ19zb3VyY2WSAxwaDAjfxPrJBhDwhZCYASIMCNbI+skGEMDEzoYDYg0KCXNhbXBsZV9pZBACggEGcHl0aG9uEhwKDAjfxPrJBhDQs46eARIMCNbI+skGEKiQ4oYDMocECuYDChdtYWx3YXJlX3NhbXBsZV9mZWF0dXJlcxIDZGZwGg5tYWx3YXJlX3NhbXBsZSIpCgthcHBfcGFja2FnZRACIhhBbmRyb2lkIGFwcCBwYWNrYWdlIG5hbWUiIwoKaXNfbWFsd2FyZRAEIhMxPW1hbHdhcmUsIDA9YmVuaWduIigKC2RhdGFfc291cmNlEAIiF2VtdWxhdG9yIG9yIHJlYWxfZGV2aWNlIigKDWRhdGFzZXRfc3BsaXQQAiIVdHJhaW4vdmFsaWRhdGlvbi90ZXN0KgsKBHRlYW0SA2RmcCoVCgdkYXRhc2V0Egprcm9ub2Ryb2lkMgUIgOeEDzrVAQgBGg9ldmVudF90aW1lc3RhbXBaUBI3czM6Ly9rcm9ub2Ryb2lkL21haW4vZGJ0L2ZjdF90cmFpbmluZ19kYXRhc2V0LyoucGFycXVldBoVaHR0cDovL2xvY2FsaG9zdDo4MDAwigExZmVhc3QuaW5mcmEub2ZmbGluZV9zdG9yZXMuZmlsZV9zb3VyY2UuRmlsZVNvdXJjZaIBGmtyb25vZHJvaWRfdHJhaW5pbmdfc291cmNlkgMcGgwI38T6yQYQ8IWQmAEiDAjWyPrJBhDAxM6GA0ABYg0KCXNhbXBsZV9pZBACEhwKDAjfxPrJBhCw/5SeARIMCNbI+skGEPCSg4cDQqQNCoMNChhtYWx3YXJlX2Rlcml2ZWRfZmVhdHVyZXMSA2RmcBoWChJpc19lbXVsYXRvcl9zYW1wbGUQBCKAAwoXbWFsd2FyZV9zYW1wbGVfZmVhdHVyZXMS5AIa4QIKF21hbHdhcmVfc2FtcGxlX2ZlYXR1cmVzEikKC2FwcF9wYWNrYWdlEAIiGEFuZHJvaWQgYXBwIHBhY2thZ2UgbmFtZRIjCgppc19tYWx3YXJlEAQiEzE9bWFsd2FyZSwgMD1iZW5pZ24SKAoLZGF0YV9zb3VyY2UQAiIXZW11bGF0b3Igb3IgcmVhbF9kZXZpY2USKAoNZGF0YXNldF9zcGxpdBACIhV0cmFpbi92YWxpZGF0aW9uL3Rlc3RCoQEIARoPZXZlbnRfdGltZXN0YW1wWlASN3MzOi8va3Jvbm9kcm9pZC9tYWluL2RidC9mY3RfdHJhaW5pbmdfZGF0YXNldC8qLnBhcnF1ZXQaFWh0dHA6Ly9sb2NhbGhvc3Q6ODAwMKIBGmtyb25vZHJvaWRfdHJhaW5pbmdfc291cmNlkgMcGgwI38T6yQYQ8IWQmAEiDAjWyPrJBhDAxM6GA1KlCQqiCQoYbWFsd2FyZV9kZXJpdmVkX2ZlYXR1cmVzEuwFgASV4QIAAAAAAACMCmRpbGwuX2RpbGyUjBBfY3JlYXRlX2Z1bmN0aW9ulJOUKGgAjAxfY3JlYXRlX2NvZGWUk5QoQwYCCCoBPAGUSwFLAEsASwJLA0sDQ2yVAFsAAAAAAAAAAABSAgAAAAAAAAAAAAAAAAAAAAAAACIANQAAAAAAAABuAVUAUwEFAAAAUwI6SAAAUgUAAAAAAAAAAAAAAAAAAAAAAABbBgAAAAAAAAAANQEAAAAAAABVAVMDJwAAAFUBJACUKIw7Q29tcHV0ZSBkZXJpdmVkIGZlYXR1cmVzIGZyb20gYmFzZSBtYWx3YXJlIHNhbXBsZSBmZWF0dXJlcy6UjAtkYXRhX3NvdXJjZZSMCGVtdWxhdG9ylIwSaXNfZW11bGF0b3Jfc2FtcGxllHSUKIwCcGSUjAlEYXRhRnJhbWWUjAZhc3R5cGWUjANpbnSUdJSMBmlucHV0c5SMAmRmlIaUjGcvVXNlcnMvYmVuamFtaW5icm93bi9Eb2N1bWVudHMvR2l0SHViL21sb3BzL2ZlYXR1cmVfc3RvcmVzL2ZlYXN0X3N0b3JlL2RmcF9mZWFzdC9rcm9ub2Ryb2lkX2ZlYXR1cmVzLnB5lIwYbWFsd2FyZV9kZXJpdmVkX2ZlYXR1cmVzlGgVS2dDNIAA9BAACgyPHIocix6AQtggJqB90SA1uBrRIEPXH0vRH0vMQ9MfUIBC0Acb0QQc2AsNgEmUQwCUKSl0lFKUfZSMCF9fbmFtZV9flIwIX19tYWluX1+Uc2gVTk50lFKUfZR9lCiMB19fZG9jX1+UaAeMD19fYW5ub3RhdGlvbnNfX5R9lChoEYwRcGFuZGFzLmNvcmUuZnJhbWWUaA2TlIwGcmV0dXJulGgldXWGlGJoGiiMAnBklGgAjA5faW1wb3J0X21vZHVsZZSTlIwGcGFuZGFzlIWUUpSMA2ludJRoAIwKX2xvYWRfdHlwZZSTlGgPhZRSlHUwLhqOA0Bvbl9kZW1hbmRfZmVhdHVyZV92aWV3KAogICAgc291cmNlcz1bbWFsd2FyZV9zYW1wbGVfZmVhdHVyZXNdLAogICAgc2NoZW1hPVsKICAgICAgICBGaWVsZChuYW1lPSJpc19lbXVsYXRvcl9zYW1wbGUiLCBkdHlwZT1JbnQ2NCksCiAgICBdLAopCmRlZiBtYWx3YXJlX2Rlcml2ZWRfZmVhdHVyZXMoaW5wdXRzOiBwZC5EYXRhRnJhbWUpIC0+IHBkLkRhdGFGcmFtZToKICAgICIiIkNvbXB1dGUgZGVyaXZlZCBmZWF0dXJlcyBmcm9tIGJhc2UgbWFsd2FyZSBzYW1wbGUgZmVhdHVyZXMuIiIiCiAgICBkZiA9IHBkLkRhdGFGcmFtZSgpCiAgICBkZlsiaXNfZW11bGF0b3Jfc2FtcGxlIl0gPSAoaW5wdXRzWyJkYXRhX3NvdXJjZSJdID09ICJlbXVsYXRvciIpLmFzdHlwZShpbnQpCiAgICByZXR1cm4gZGYKIgZwYW5kYXNaBnBhbmRhc2oHX19kdW1teXIOCgpfX2R1bW15X2lkEAISHAoMCN/E+skGEJj4mZ4BEgwI1sj6yQYQyOyhhwNi3AEIARoOX2RidF9sb2FkZWRfYXRaUBI3czM6Ly9rcm9ub2Ryb2lkL21haW4vZGJ0L2RpbV9tYWx3YXJlX2ZhbWlsaWVzLyoucGFycXVldBoVaHR0cDovL2xvY2FsaG9zdDo4MDAwigExZmVhc3QuaW5mcmEub2ZmbGluZV9zdG9yZXMuZmlsZV9zb3VyY2UuRmlsZVNvdXJjZaIBHGtyb25vZHJvaWRfY2F0ZWdvcmllc19zb3VyY2WqAQNkZnCSAxwaDAjfxPrJBhDw9pSYASIMCNbI+skGEIjCx4YDYtsBCAEaD2V2ZW50X3RpbWVzdGFtcFpQEjdzMzovL2tyb25vZHJvaWQvbWFpbi9kYnQvZmN0X3RyYWluaW5nX2RhdGFzZXQvKi5wYXJxdWV0GhVodHRwOi8vbG9jYWxob3N0OjgwMDCKATFmZWFzdC5pbmZyYS5vZmZsaW5lX3N0b3Jlcy5maWxlX3NvdXJjZS5GaWxlU291cmNlogEaa3Jvbm9kcm9pZF90cmFpbmluZ19zb3VyY2WqAQNkZnCSAxwaDAjfxPrJBhDwhZCYASIMCNbI+skGEMDEzoYDYtkBCAEaD2V2ZW50X3RpbWVzdGFtcFpPEjZzMzovL2tyb25vZHJvaWQvbWFpbi9kYnQvZmN0X21hbHdhcmVfc2FtcGxlcy8qLnBhcnF1ZXQaFWh0dHA6Ly9sb2NhbGhvc3Q6ODAwMIoBMWZlYXN0LmluZnJhLm9mZmxpbmVfc3RvcmVzLmZpbGVfc291cmNlLkZpbGVTb3VyY2WiARlrcm9ub2Ryb2lkX3NhbXBsZXNfc291cmNlqgEDZGZwkgMcGgwI38T6yQYQ0N2SmAEiDAjWyPrJBhDQg9SGA2KVAggJGg9ldmVudF90aW1lc3RhbXCKARxmZWFzdC5kYXRhX3NvdXJjZS5QdXNoU291cmNlogEWa3Jvbm9kcm9pZF9wdXNoX3NvdXJjZaoBA2RmcNIBoQEIARoPZXZlbnRfdGltZXN0YW1wWlASN3MzOi8va3Jvbm9kcm9pZC9tYWluL2RidC9mY3RfdHJhaW5pbmdfZGF0YXNldC8qLnBhcnF1ZXQaFWh0dHA6Ly9sb2NhbGhvc3Q6ODAwMKIBGmtyb25vZHJvaWRfdHJhaW5pbmdfc291cmNlkgMcGgwI38T6yQYQ8IWQmAEiDAjWyPrJBhDAxM6GA5IDHBoMCN/E+skGEJCQl5gBIgwI1sj6yQYQwKPZhgOKASUKBQoDZGZwEhwKDAjfxPrJBhDAw9SYARIMCNbI+skGEOjR6oMD
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: feast-feature-store
  namespace: dfp
data:
  feature_store.yaml: |
    project: dfp
    provider: local

    registry:
      path: /feast/registry.db
      cache_ttl_seconds: 60

    offline_store:
      type: spark
      spark_conf:
        spark.sql.extensions: org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
        spark.sql.catalog.lakefs_catalog: org.apache.iceberg.spark.SparkCatalog
        spark.sql.catalog.lakefs_catalog.type: hadoop
        spark.sql.catalog.lakefs_catalog.warehouse: ${LAKEFS_WAREHOUSE:-s3a://kronodroid/main/iceberg}
        spark.hadoop.fs.s3a.endpoint: ${LAKEFS_ENDPOINT_URL:-http://lakefs.dfp.svc.cluster.local:8000}
        spark.hadoop.fs.s3a.access.key: ${LAKEFS_ACCESS_KEY_ID:-}
        spark.hadoop.fs.s3a.secret.key: ${LAKEFS_SECRET_ACCESS_KEY:-}
        spark.hadoop.fs.s3a.path.style.access: "true"
        spark.hadoop.fs.s3a.impl: org.apache.hadoop.fs.s3a.S3AFileSystem
        spark.hadoop.fs.s3a.connection.ssl.enabled: "false"
        spark.sql.iceberg.write.format.default: avro
        spark.driver.memory: 2g
        spark.executor.memory: 2g

    online_store:
      type: redis
      connection_string: ${REDIS_CONNECTION_STRING:-redis://redis.dfp.svc.cluster.local:6379}

    entity_key_serialization_version: 3

